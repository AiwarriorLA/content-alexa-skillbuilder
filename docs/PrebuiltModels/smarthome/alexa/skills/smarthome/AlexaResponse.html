<!DOCTYPE html>

<html>
<head>
  <title>`AlexaResponse`</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../../../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="alexaresponse"><code>AlexaResponse</code></h1>
<p>Response Messages for Smart Home </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-meta">
'use strict'</span>;

<span class="hljs-keyword">let</span> uuid = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uuid'</span>);

 
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AlexaResponse</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p> Check a value for validity or return a default.
 <br> <strong>Value</strong>  The value being checked
 <br> <strong>defaultValue</strong>  A default value if the passed value is not valid
 <br> <strong>returns {*}</strong>  The passed value if valid otherwise the default value.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    checkValue(value, defaultValue) {

        <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span> || value === {} || value === <span class="hljs-string">""</span>)
            <span class="hljs-keyword">return</span> defaultValue;

        <span class="hljs-keyword">return</span> value;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h1 id="constructor"><code>Constructor</code></h1>
<p> The Alexa Response Constructor this create JSON Response which corresponds 
 to the format required or a Smart Device
 <br> <strong>constructor</strong>
 <br> <strong>opts</strong> Contains initialization options for the response</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">constructor</span>(opts) {

        <span class="hljs-keyword">if</span> (opts === <span class="hljs-literal">undefined</span>)
            opts = {};

        <span class="hljs-keyword">if</span> (opts.context !== <span class="hljs-literal">undefined</span>)
        {
            <span class="hljs-keyword">this</span>.context = <span class="hljs-keyword">this</span>.checkValue(opts.context, <span class="hljs-literal">undefined</span>);
        }

        <span class="hljs-keyword">if</span> (opts.event !== <span class="hljs-literal">undefined</span>)
        {
            <span class="hljs-keyword">this</span>.event = <span class="hljs-keyword">this</span>.checkValue(opts.event, <span class="hljs-literal">undefined</span>);
        }
        <span class="hljs-keyword">else</span>
        {
                <span class="hljs-keyword">this</span>.event = {
                <span class="hljs-string">"header"</span>: {
                    <span class="hljs-string">"namespace"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.namespace, <span class="hljs-string">"Alexa"</span>),
                    <span class="hljs-string">"name"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.name, <span class="hljs-string">"Response"</span>),
                    <span class="hljs-string">"messageId"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.messageId, uuid()),
                    <span class="hljs-string">"correlationToken"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.correlationToken, <span class="hljs-literal">undefined</span>),
                    <span class="hljs-string">"payloadVersion"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.payloadVersion, <span class="hljs-string">"3"</span>)
                },
                <span class="hljs-string">"endpoint"</span>: {
                    <span class="hljs-string">"scope"</span>: {
                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"BearerToken"</span>,
                        <span class="hljs-string">"token"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.token, <span class="hljs-string">"INVALID"</span>),
                    },
                    <span class="hljs-string">"endpointId"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.endpointId, <span class="hljs-string">"INVALID"</span>)
                },
                <span class="hljs-string">"payload"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.payload, {})
                };
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>No endpoint in an AcceptGrant or Discover request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.event.header.name === <span class="hljs-string">"AcceptGrant.Response"</span> || <span class="hljs-keyword">this</span>.event.header.name === <span class="hljs-string">"Discover.Response"</span>)
        {
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.event.endpoint;
        }

    }</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h1 id="addcontextproperty"><code>addContextProperty</code></h1>
<p> Add a property to the context.
 <br>  <strong>opts</strong> Contains options for the property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addContextProperty(opts) {

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.context === <span class="hljs-literal">undefined</span>)
            <span class="hljs-keyword">this</span>.context = {<span class="hljs-attr">properties</span>: []};

        <span class="hljs-keyword">this</span>.context.properties.push(<span class="hljs-keyword">this</span>.createContextProperty(opts));
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h1 id="addpayloadendpoint"><code>addPayloadEndpoint</code></h1>
<p>  Add an endpoint to the payload.
  <br> <strong>opts</strong> Contains options for the endpoint.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>     
    addPayloadEndpoint(opts) {

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.event.payload.endpoints === <span class="hljs-literal">undefined</span>)
            <span class="hljs-keyword">this</span>.event.payload.endpoints = [];

        <span class="hljs-keyword">this</span>.event.payload.endpoints.push(<span class="hljs-keyword">this</span>.createPayloadEndpoint(opts));
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h1 id="createcontextproperty"><code>createContextProperty</code></h1>
<p>  Creates a property for the context.
  <br> <strong>opts</strong> Contains options for the property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    createContextProperty(opts) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'namespace'</span>: <span class="hljs-keyword">this</span>.checkValue(opts.namespace, <span class="hljs-string">"Alexa.EndpointHealth"</span>),
            <span class="hljs-string">'name'</span>: <span class="hljs-keyword">this</span>.checkValue(opts.name, <span class="hljs-string">"connectivity"</span>),
            <span class="hljs-string">'value'</span>: <span class="hljs-keyword">this</span>.checkValue(opts.value, {<span class="hljs-string">"value"</span>: <span class="hljs-string">"OK"</span>}),
            <span class="hljs-string">'timeOfSample'</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
            <span class="hljs-string">'uncertaintyInMilliseconds'</span>: <span class="hljs-keyword">this</span>.checkValue(opts.uncertaintyInMilliseconds, <span class="hljs-number">0</span>)
        };
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h1 id="createpayloadendpoint"><code>createPayloadEndpoint</code></h1>
<p> Creates an endpoint for the payload.
 <br> <strong>opts</strong> Contains options for the endpoint.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
    createPayloadEndpoint(opts) {

        <span class="hljs-keyword">if</span> (opts === <span class="hljs-literal">undefined</span>) opts = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Return the proper structure expected for the endpoint</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">let</span> endpoint =
            {
                <span class="hljs-string">"capabilities"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.capabilities, []),
                <span class="hljs-string">"description"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.description, <span class="hljs-string">"Lambda Endpoint for Smart Device Lab"</span>),
                <span class="hljs-string">"displayCategories"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.displayCategories, [<span class="hljs-string">"OTHER"</span>]),
                <span class="hljs-string">"endpointId"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.endpointId, <span class="hljs-string">'endpoint-001'</span>),
                <span class="hljs-string">"friendlyName"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.friendlyName, <span class="hljs-string">"Lab Endpoint"</span>),
                <span class="hljs-string">"manufacturerName"</span>: <span class="hljs-keyword">this</span>.checkValue(opts.manufacturerName, <span class="hljs-string">"Linux Academy"</span>)
            };

        <span class="hljs-keyword">if</span> (opts.hasOwnProperty(<span class="hljs-string">"cookie"</span>))
            endpoint[<span class="hljs-string">"cookie"</span>] = <span class="hljs-keyword">this</span>.checkValue(<span class="hljs-string">'cookie'</span>, {});

        <span class="hljs-keyword">return</span> endpoint
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h1 id="createpayloadendpointcapability"><code>createPayloadEndpointCapability</code></h1>
<p> Creates a capability for an endpoint within the payload.
 <br> <strong>opts</strong> Contains options for the endpoint capability.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    createPayloadEndpointCapability(opts) {

        <span class="hljs-keyword">if</span> (opts === <span class="hljs-literal">undefined</span>) opts = {};

        <span class="hljs-keyword">let</span> capability = {};
        capability[<span class="hljs-string">'type'</span>] = <span class="hljs-keyword">this</span>.checkValue(opts.type, <span class="hljs-string">"AlexaInterface"</span>);
        capability[<span class="hljs-string">'interface'</span>] = <span class="hljs-keyword">this</span>.checkValue(opts.interface, <span class="hljs-string">"Alexa"</span>);
        capability[<span class="hljs-string">'version'</span>] = <span class="hljs-keyword">this</span>.checkValue(opts.version, <span class="hljs-string">"3"</span>);
        <span class="hljs-keyword">let</span> supported = <span class="hljs-keyword">this</span>.checkValue(opts.supported, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (supported) {
            capability[<span class="hljs-string">'properties'</span>] = {};
            capability[<span class="hljs-string">'properties'</span>][<span class="hljs-string">'supported'</span>] = supported;
            capability[<span class="hljs-string">'properties'</span>][<span class="hljs-string">'proactivelyReported'</span>] = <span class="hljs-keyword">this</span>.checkValue(opts.proactivelyReported, <span class="hljs-literal">false</span>);
            capability[<span class="hljs-string">'properties'</span>][<span class="hljs-string">'retrievable'</span>] = <span class="hljs-keyword">this</span>.checkValue(opts.retrievable, <span class="hljs-literal">false</span>);
        }
        <span class="hljs-keyword">return</span> capability
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h1 id="get"><code>get</code></h1>
<p> Get the composed Alexa Response.
 <br> <strong>returns {AlexaResponse}</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">get</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
}

<span class="hljs-built_in">module</span>.exports = AlexaResponse;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
